<html>
<head>
    <script type="text/javascript" src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="src/two.js"></script>
    <script type="text/javascript" src="src/Agent/agent.js"></script>
    <script type="text/javascript" src="src/Swarm/swarm.js"></script>
    <script type="text/javascript" src="src/Targets/mouseTarget.js"></script>
    <script type="text/javascript" src="src/Targets/target.js"></script>
    <script type="text/javascript" src="src/Targets/targetCollection.js"></script>
    <script type="text/javascript" src="src/Targets/targetGroup.js"></script>
    <script type="text/javascript" src="src/Targets/targetGroupCache.js"></script>
    <script type="text/javascript" src="src/systemParameters.js"></script>
    <script type="text/javascript" src="src/utils.js"></script>

    <style>
        body {
            background-color: black;
            color: white;
        }

        #canvas {
            height: 90%;
            width: 90%;
        }
    </style>
</head>
<body>
<div id="canvas" style="background: black"></div>
<script type="text/javascript">
    var utils = new Utils(),
        systemParameters = new SystemParameters(utils);

    var elem = document.getElementById('canvas');
    var playArea = {
        width: $(window).width() - 20,
        height: $(window).height() - 40
    };

    var two = new Two(playArea).appendTo(elem);

    var beeCollection = new Swarm(two, playArea, utils, systemParameters),
        targetCollection = new TargetCollection(two, playArea, utils, systemParameters);

    targetCollection.spawnMouseTarget();

    for (var i = 0; i < systemParameters.targets; i++) {
        targetCollection.spawnTarget();
    };

    for(var i = 0; i < systemParameters.bees; i ++) {
        beeCollection.spawnAgent();
    };

    var targetGroupCache = new TargetGroupCache(targetCollection, systemParameters);

    two.bind('update', function () {
        targetCollection.update();

        var groupedBees = targetGroupCache.getGroup(beeCollection.agents);
        beeCollection.update(groupedBees);
    });

    if(systemParameters.frameThrottle) {
        two.play();
    } else {
        // will run the game as fast as possible.
        // used for debugging perf
        setInterval(function () { two.update(); }, 0);
    }
</script>
</body>
</html>
